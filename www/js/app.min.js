'use strict';

var app = angular.module('Application', [
	'ngTouch',
	'ngAnimate',
	'ngCordova',
	'ngResource',
	'ngMaterial',
	'ngMdIcons',
	'pascalprecht.translate',
	'ui.router'
]);

angular.module('Application')
	.config(["$stateProvider", "$urlRouterProvider", function ($stateProvider, $urlRouterProvider) {

		// For any unmatched url, redirect to /tabs while there is no dashboard page
		$urlRouterProvider.otherwise("/tabs");

		// Now set up the states
		$stateProvider
			.state('dashboard', {
				url: "/dashboard",
				templateUrl: "webapp/views/dashboard.html",
				controller: 'DashboardCtrl',
				controllerAs: 'dashboard'
			})
			.state('tabs', {
				url: "/tabs",
				templateUrl: "webapp/views/tabs.html",
				controller: 'TabsCtrl',
				controllerAs: 'tabs'
			})
			.state('api', {
				url: "/api",
				templateUrl: "webapp/views/api.html",
				controller: 'ApiCtrl',
				controllerAs: 'api'
			})
			.state('apiMessages', {
				url: "/api/messages",
				templateUrl: "webapp/views/messages.html",
				controller: 'MessagesCtrl',
				controllerAs: 'messages'
			})
			.state('apiCars', {
				url: "/api/cars",
				templateUrl: "webapp/views/cars.html",
				controller: 'CarsCtrl',
				controllerAs: 'cars'
			})
			.state('apiShowCar', {
				url: "/api/car/:carId",
				templateUrl: "webapp/views/car-detail.html",
				controller: 'CarCtrl',
				controllerAs: 'car'
			})
			.state('dialogs', {
				url: "/dialogs",
				templateUrl: "webapp/views/dialogs.html",
				controller: 'dialogsCtrl',
				controllerAs: 'dialogs'
			})
			.state('cards', {
				url: "/cards",
				templateUrl: "webapp/views/cards.html",
				controller: 'CardsCtrl',
				controllerAs: 'cards'
			})
			.state('camera', {
				url: "/plugins/camera",
				templateUrl: "webapp/views/plugins/picture.html",
				controller: 'PictureCtrl',
				controllerAs: 'picture'
			})
			.state('deviceInfo', {
				url: "/plugins/deviceInfo",
				templateUrl: "webapp/views/plugins/device-info.html",
				controller: 'DeviceInfoCtrl',
				controllerAs: 'device'
			})
			.state('login', {
				url: "/auth/login",
				templateUrl: "webapp/views/auth/login.html",
				controller: 'LoginCtrl',
				controllerAs: 'login'
			});
	}])
	.config(["$mdThemingProvider", function ($mdThemingProvider) {
		$mdThemingProvider.theme('default')
			.primaryPalette('blue')
			.accentPalette('amber');

		$mdThemingProvider.theme('pink')
			.primaryPalette('pink', {
				'default': '400', // by default use shade 400 from the pink palette for primary intentions
				'hue-1': '100', // use shade 100 for the <code>md-hue-1</code> class
				'hue-2': '600', // use shade 600 for the <code>md-hue-2</code> class
				'hue-3': 'A100' // use shade A100 for the <code>md-hue-3</code> class
			})
			// If you specify less than all of the keys, it will inherit from the
			// default shades
			.accentPalette('purple', {
				'default': '200' // use shade 200 for default, and keep all other shades the same
			});
			//$mdThemingProvider.disableTheming();
	}])
	.config(["$compileProvider", function ($compileProvider) {
		$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|http|ftp|mailto|file|tel):/);
	}])
	.config(["$translateProvider", function ($translateProvider) {

		$translateProvider.preferredLanguage('en');
		$translateProvider.useSanitizeValueStrategy('escape');
		$translateProvider.useStaticFilesLoader({
			prefix: 'languages/',
			suffix: '.json'
		});

	}]);

app.controller('ApiCtrl', [ 'UtilService', function(UtilService) {

  var vm = this;

  vm.util = UtilService;

}]);

app.controller('AppCtrl', ['$mdSidenav', '$timeout','$log', '$location', '$translate', '$filter', '$state', function($mdSidenav, $timeout, $log, $location, $translate, $filter, $state) {

            var vm = this;

            vm.itensMenu = [
              {
                  nome: 'DASHBOARD',
                  icone: 'dashboard',
                  //iconeCor: 'pink',
                  state: 'dashboard'
              },
              {
                  nome: 'TABS',
                  icone: 'tab',
                  //iconeCor: 'red',
                  state: 'tabs'
              },
              {
                  nome: 'RESTFUL_TEST',
                  icone: 'sync',
                  //iconeCor: 'pink',
                  state: 'api'
              },
              {
                  nome: 'DIALOGS',
                  icone: 'chat',
                  //iconeCor: 'pink',
                  state: 'dialogs'
              },
              {
                  nome: 'CARDS',
                  icone: 'view_stream',
                  //iconeCor: 'pink',
                  state: 'cards'
              },
              {
                  nome: 'CAMERA',
                  icone: 'camera',
                  //iconeCor: 'pink',
                  state: 'camera'
              },
              {
                  nome: 'DEVICE_INFO',
                  icone: 'perm_device_info',
                  //iconeCor: 'pink',
                  state: 'deviceInfo'
              }
            ];

            vm.selected = null;

            vm.toggleMenu = function (name) {
              $mdSidenav(name).toggle();
            }

            vm.selectItem = function(itemState) {
              vm.selected = angular.isNumber(itemState) ? vm.itensMenu[itemState.index] : itemState;
              $state.go(itemState);
              vm.toggleMenu('left');
            }

            vm.changeLanguage = function(langKey) {
              $translate.use(langKey);
            };

}]);

app.controller('CarCtrl', [ 'CarService', 'UtilService','$location', '$stateParams', function(CarService, UtilService,$location, $stateParams) {
  // A simple controller that fetches a list of data from a service
  // "Cars" is a service returning mock data (CarService.js)
  var vm = this;

  vm.car = {};
  vm.carId = $stateParams.carId;
  vm.util = UtilService;

  function getCar(carId)
  {
      vm.car = CarService.get(carId);
  }

  getCar(vm.carId);

}]);

app.controller('CardsCtrl', ['$mdDialog', function ($mdDialog) {
	var vm = this;
	vm.imagePath = 'img/angular-logo.svg';
	vm.allCards = [
		{
			'title': 'Fiscolas',
			'text': 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus malesuada aliquam ante, sit amet commodo mi iaculis et. Morbi sed lectus lectus.'
		},
		{
			'title': 'Fiscolandia',
			'text': 'Proin dictum, augue non egestas placerat, turpis odio convallis quam, at feugiat orci nulla venenatis mauris. Nullam condimentum auctor odio nec venenatis. Cras placerat ligula nec ipsum consectetur ullamcorper. Vivamus a eros volutpat, pretium nunc semper, ornare nunc. Aenean vulputate enim nisl, in euismod nibh euismod id. Nullam pulvinar erat nec nisl iaculis molestie. Praesent a felis auctor, facilisis risus in, vestibulum tortor. Suspendisse volutpat, erat ut hendrerit sodales, arcu lectus rutrum nisi, vitae posuere arcu enim mattis eros.'
		},
		{
			'title': 'FiscoNunes',
			'text': 'Proin dictum, augue non egestas placerat, turpis odio convallis quam, at feugiat orci nulla venenatis mauris. Nullam condimentum auctor odio nec venenatis. Cras placerat ligula nec ipsum consectetur ullamcorper. Vivamus a eros volutpat, pretium nunc semper, ornare nunc. Aenean vulputate enim nisl, in euismod nibh euismod id. Nullam pulvinar erat nec nisl iaculis molestie. Praesent a felis auctor, facilisis risus in, vestibulum tortor. Suspendisse volutpat, erat ut hendrerit sodales, arcu lectus rutrum nisi, vitae posuere arcu enim mattis eros.'
		},
		{
			'title': 'Fiscolangelo',
			'text': 'Proin dictum, augue non egestas placerat, turpis odio convallis quam, at feugiat orci nulla venenatis mauris. Nullam condimentum auctor odio nec venenatis. Cras placerat ligula nec ipsum consectetur ullamcorper. Vivamus a eros volutpat, pretium nunc semper, ornare nunc. Aenean vulputate enim nisl, in euismod nibh euismod id. Nullam pulvinar erat nec nisl iaculis molestie. Praesent a felis auctor, facilisis risus in, vestibulum tortor. Suspendisse volutpat, erat ut hendrerit sodales, arcu lectus rutrum nisi, vitae posuere arcu enim mattis eros.'
		}
	];

	var originatorEv;

	vm.openMenu = function ($mdOpenMenu, ev) {
		originatorEv = ev;
		$mdOpenMenu(ev);
	};

	vm.addCard = function (card) {
		vm.allCards.push(card);
		vm.newCard = null;
	}

	vm.edit = function () {
		$mdDialog.show(
			$mdDialog.alert()
				.targetEvent(originatorEv)
				.clickOutsideToClose(true)
				.parent('body')
				.title('You clicked the edit button!')
				.content('Thats just an example of how easy it is to define actions on ng-click.')
				.ok('Awesome!')
		);

		originatorEv = null;
	};

	vm.delete = function (card) {
		var index = vm.allCards.indexOf(card);
		vm.allCards.splice(index, 1);
	};

	//console.log(vm.allCards);

}]);

app.controller('CarsCtrl', [ 'CarService', 'UtilService', '$location', '$state', function(CarService, UtilService, $location, $state) {
  // A simple controller that fetches a list of data from a service
  // "Cars" is a service returning mock data (CarService.js)
  var vm = this;

  vm.cars = [];

  vm.util = UtilService;

  vm.getCars = function(){
      vm.cars = CarService.all();
  };

  vm.getDetail = function(id){
    $state.go('apiShowCar', { carId: id });
  }
}]);

app.controller('DashboardCtrl', ["$scope", "$mdSidenav", "$mdUtil", "$mdToast", function ($scope, $mdSidenav, $mdUtil, $mdToast) {
	var last = {
		bottom: false,
		top: true,
		left: false,
		right: true
	};

	$scope.toastPosition = angular.extend({}, last);

	$scope.getToastPosition = function () {
		sanitizePosition();

		return Object.keys($scope.toastPosition)
			.filter(function (pos) {
				return $scope.toastPosition[pos];
			})
			.join(' ');
	};

	function sanitizePosition() {
		var current = $scope.toastPosition;

		if (current.bottom && last.top) current.top = false;
		if (current.top && last.bottom) current.bottom = false;
		if (current.right && last.left) current.left = false;
		if (current.left && last.right) current.right = false;

		last = angular.extend({}, current);
	}

	$scope.showSimpleToast = function () {
		var pinTo = $scope.getToastPosition();

		$mdToast.show(
			$mdToast.simple()
				.textContent('Simple Toast!')
				.position(pinTo)
				.hideDelay(3000)
		);
	};

	$scope.showActionToast = function () {
		var pinTo = $scope.getToastPosition();
		var toast = $mdToast.simple()
			.textContent('Marked as read')
			.action('UNDO')
			.highlightAction(true)
			.highlightClass('md-accent')// Accent is used by default, this just demonstrates the usage.
			.position(pinTo);

		$mdToast.show(toast).then(function (response) {
			if (response == 'ok') {
				alert('You clicked the \'UNDO\' action.');
			}
		});
	};
}])
	.controller('ToastCtrl', ["$scope", "$mdToast", function ($scope, $mdToast) {
		$scope.closeToast = function () {
			$mdToast.hide();
		};
	}]);

app.controller('DeviceInfoCtrl', ['$cordovaDevice', function($cordovaDevice) {

  var vm = this;

  document.addEventListener("deviceready", function () {

     vm.device = $cordovaDevice.getDevice();
     vm.cordova = $cordovaDevice.getCordova();
     vm.model = $cordovaDevice.getModel();
     vm.platform = $cordovaDevice.getPlatform();
     vm.uuid = $cordovaDevice.getUUID();
     vm.version = $cordovaDevice.getVersion();

  }, false);

}]);

app.controller('dialogsCtrl', ['$mdDialog', '$filter', function($mdDialog, $filter) {

  var vm = this;

  vm.status = ' ';

  vm.showAlert = function(ev) {
    $mdDialog.show(
      $mdDialog.alert()
        .parent(angular.element(document.querySelector('#popupContainer')))
        .clickOutsideToClose(true)
        .title($filter('translate')('MESSAGE'))
        .content('Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque cursus sagittis lorem, nec semper neque vulputate at. Proin tempus odio ex, nec commodo leo accumsan in. Aenean ornare sed neque ac accumsan. Vestibulum sed dictum nulla. Phasellus finibus faucibus tristique. Ut hendrerit et sem sit amet elementum. Phasellus dapibus placerat tellus. Duis a quam aliquet diam fermentum eleifend. Etiam eget turpis semper, laoreet turpis ut, lacinia neque.')
        .ariaLabel('Alert 1')
        .ok('OK')
        .targetEvent(ev)
    );
  };

  vm.showConfirm = function(ev) {
    // Appending dialog to document.body to cover sidenav in docs app
    var confirm = $mdDialog.confirm()
          .title($filter('translate')('MESSAGE'))
          .content('Mauris non congue erat. Nunc odio ipsum, pellentesque at ullamcorper nec, lacinia vitae diam. Praesent ultrices, magna luctus tincidunt hendrerit, mauris massa iaculis dui, quis fermentum ex ipsum id ante. Duis non tellus condimentum, semper turpis nec, feugiat mi. Nulla cursus, enim quis euismod ultrices, massa ligula imperdiet felis, ac venenatis odio mi nec leo. Donec malesuada vehicula metus, volutpat pharetra velit lacinia a. Aenean neque elit, convallis imperdiet augue sit amet, rhoncus malesuada sapien. Proin accumsan nibh non nibh dictum, vitae aliquet tellus convallis. Aliquam id felis at lacus accumsan gravida eu in lorem. Cras rutrum risus vel metus ornare fringilla.')
          .ariaLabel('Test')
          .ok('OK!')
          .cancel('No')
          .targetEvent(ev);
    $mdDialog.show(confirm).then(function() {

      vm.status = 'Clicked OK';

    }, function() {

      vm.status = 'Clicked no :(';

    });
  };

}]);

app
.config(["$mdIconProvider", function($mdIconProvider) {
  $mdIconProvider
    .iconSet('communication', 'img/icons/sets/communication-icons.svg', 24);
}])
.controller('MessagesCtrl', ['Post', 'UtilService', function (Post, UtilService) {

	var vm = this;

	vm.messages = [];

	vm.util = UtilService;

	Post.query(function (data) {
		vm.messages = data;
		console.log(vm.messages);
	});

}]);

app.controller('PictureCtrl', [ '$cordovaCamera', function($cordovaCamera) {

  var vm = this;

  vm.takePicture = function() {
    var options = {
      quality: 100,
      destinationType: Camera.DestinationType.FILE_URI,
      sourceType: Camera.PictureSourceType.CAMERA,
      allowEdit: false,
      encodingType: Camera.EncodingType.JPEG,
      //targetWidth: 300,
      //targetHeight: 300,
      popoverOptions: CameraPopoverOptions,
      saveToPhotoAlbum: false
    };

    $cordovaCamera.getPicture(options).then(function(imageData) {
      var image = document.getElementById('my-image');
      image.src = imageData;
    }, function(err) {
      // error
    });
  }

  vm.cleanPicture = function() {
    var image = document.getElementById('my-image');
    image.src = 'img/no-picture.png';
  }

}]);

app.controller('TabsCtrl', ["$scope", "$mdSidenav", "$mdUtil", "$log", function ($scope, $mdSidenav, $mdUtil, $log) {

	var tabs = [
			{title: 'One', content: "Tabs will become paginated if there isn't enough room for them."},
			{title: 'Two', content: "You can swipe left and right on a mobile device to change tabs."},
			{title: 'Three', content: "You can bind the selected tab via the selected attribute on the md-tabs element."},
			{title: 'Four', content: "If you set the selected tab binding to -1, it will leave no tab selected."},
			{title: 'Five', content: "If you remove a tab, it will try to select a new one."},
			{title: 'Six', content: "There's an ink bar that follows the selected tab, you can turn it off if you want."},
			{
				title: 'Seven',
				content: "If you set ng-disabled on a tab, it becomes unselectable. If the currently selected tab becomes disabled, it will try to select the next tab."
			},
			{title: 'Eight', content: "If you look at the source, you're using tabs to look at a demo for tabs. Recursion!"},
			{title: 'Nine', content: "If you set md-theme=\"green\" on the md-tabs element, you'll get green tabs."},
			{title: 'Ten', content: "If you're still reading this, you should just go check out the API docs for tabs!"}
		],
		selected = null,
		previous = null;
	$scope.tabs = tabs;
	$scope.selectedIndex = 2;
	$scope.$watch('selectedIndex', function (current, old) {
		previous = selected;
		selected = tabs[current];
		if (old + 1 && (old != current)) $log.debug('Goodbye ' + previous.title + '!');
		if (current + 1) $log.debug('Hello ' + selected.title + '!');
	});
	$scope.addTab = function (title, view) {
		view = view || title + " Content View";
		tabs.push({title: title, content: view, disabled: false});
	};
	$scope.removeTab = function (tab) {
		var index = tabs.indexOf(tab);
		tabs.splice(index, 1);
	};

}]);

app.factory('CarService', function() {
  // Might use a resource here that returns a JSON array
  // I'll do it later =)
  // Some fake testing data
  var cars = [
    {
      id: 0,
      title: 'Ferrari',
      description: 'Ferrari S.p.A. is an Italian luxury sports car manufacturer based in Maranello. Founded by Enzo Ferrari in 1929, as Scuderia Ferrari, the company sponsored drivers and manufactured race cars before moving into production of street-legal vehicles in 1947. Fiat acquired 50% of Ferrari in 1969 and expanded its stake to 90% in 1988. Ferrari is the worlds most powerful brand according to Brand Finance. In May 2012 the 1962 Ferrari 250 GTO became the most expensive car in history, selling in a private transaction for $38,115,000 to American communications magnate Craig McCaw. In 2014 Fiat announced its intentions to sell a portion of its share in Ferrari; as of the announcement Fiat owned 90% of Ferrari.',
      mainImage: 'http://buyersguide.caranddriver.com/media/assets/submodel/6866.jpg',
      images:[
        {
          title: 'Ferrari Image One',
          url:  'http://car-pictures.cars.com/images/?IMG=USC30FRC151A021001.png&WIDTH=624&HEIGHT=300&AUTOTRIM=1'
        },
        {
          title: 'Ferrari Image Two',
          url:  'http://pictures.topspeed.com/IMG/crop/201608/2014-ferrari-laferrari-26_600x0w.jpg'
        },
        {
          title: 'Ferrari Image Three',
          url:  'http://www.saopaolo.ferraridealers.com/siteasset/ferraridealer/4f74a1a219b2b/961/420/selected/-216/0/0/4f74a1a219b2b.jpg'
        }
      ],
      facts: [
        {
          title: 'Ferrari Curiosity One',
          text: 'Text'
        },
        {
          title: 'Ferrari Curiosity Two',
          text: 'Text'
        },
        {
          title: 'Ferrari Curiosity Three',
          text: 'Text'
        }
      ]
    },
    {
      id: 1,
      title: 'Lamborghini Veneno',
      description: 'The Lamborghini Veneno is consistently focused on optimum aerodynamics and cornering stability, giving the Veneno the real dynamic experience of a racing prototype, yet it is fully homologated for the road.',
      mainImage: 'http://casadelaeromodelista.com/wp-content/uploads/2015/10/Lamborghini-Veneno-Lenkr-PedaleSilber40M.png.jpg',
      images:[
        {
          title: 'Image One',
          url:  'http://thenewswheel.com/wp-content/uploads/2016/03/Lamborghini-Veneno-at-2013-Genava-Motor-Show--760x410.jpg'
        },
        {
          title: 'Image Two',
          url:  'http://www.autoguide.com/auto-news/wp-content/uploads/2013/03/Lamborghini-Veneno-awesome1.jpg'
        },
        {
          title: 'Image Three',
          url:  'http://ag-spots-2016.o.auroraobjects.eu/2016/02/05/lamborghini-veneno-roadster-c602305022016212810_3.jpg'
        }
      ],
      facts: [
        {
          title: 'Less Weight, More driving fun',
          text: 'The systematic, carbon-fiber, lightweight design is not only visible, it is also evident on the scales: With a power-to-weight ratio of 1.93 kg/hp (4,25 lbs/hp) and its forceful twelve-cylinder the Veneno guarantees a performance that is nothing short of mind-blowing.'
        },
        {
          title: 'High Tech Interior',
          text: 'Carbon fiber dominates the interior of the Veneno, too. The carbon fiber monocoque becomes visible inside the car in the area of the central tunnel and the sills. The two lightweight bucket seats are made from Lamborghini’s patented Forged Composite. The lightweight woven carbon-fiber CarbonSkin® is used to clad the entire cockpit, part of the seats and the headliner. These measures help reduce the weight and increase the driving fun.'
        },
        {
          title: 'Ready for any turn',
          text: 'Carbon fiber dominates the interior of the Veneno, too. The carbon fiber monocoque becomes visible inside the car in the area of the central tunnel and the sills. The two lightweight bucket seats are made from Lamborghini’s patented Forged Composite. The lightweight woven carbon-fiber CarbonSkin® is used to clad the entire cockpit, part of the seats and the headliner. These measures help reduce the weight and increase the driving fun.'
        }
      ]
    }
  ];

  return {
    all: function() {
      return cars;
    },
    get: function(carId) {
      return cars[carId];
    }
  }
});

app.factory("Post", ["$resource", function($resource) {
  
  return $resource("messages.json");

}]);

app.service("testeService",["$q","$http", function ($q,$http) {



}]);

app.factory('UtilService', [ '$location', function($location) {
  return {
    linkTo: function(view) {
      $location.path(view);
    }
  }
}]);

app.controller('LoginCtrl', ['$filter', function ($filter) {

}]);

//# sourceMappingURL=app.min.js.map
